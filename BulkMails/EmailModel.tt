<#@ output extension=".cs" #>
<#@ template debug="false"  hostspecific="true" language="C#" #>

<#@ import namespace="System" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ assembly name="$(ProjectDir)..\TaskQueue\bin\Debug\TaskQueue.dll" #>
<#@ assembly name="$(ProjectDir)..\TaskClient\bin\Debug\TaskClient.dll" #>
<#
    // 1. Check for TaskClient, TaskQueue, ServiceStack dependencies contains in bin\debug directory
    // 2. Check parameters below and make sure taskmq daemon with restservice is ready and well configured

    // PARAMETERS
    string MessageType = "EMail";
    string RestApiBaseUri = "http://127.0.0.1:82/";
#>
<# 
    System.IO.Directory.SetCurrentDirectory(this.Host.ResolvePath("bin\\debug"));
    
    Dictionary<string, TaskQueue.RepresentedModelValue> result = null;
    TaskQueue.RepresentedModel model = null;
    try
    {
        TaskClient.Clients.HttpRest restService = new TaskClient.Clients.HttpRest(RestApiBaseUri);
        model = restService.GetValidationInfo(MessageType);
        
        result = model.schema.ToDictionary();
    }catch(Exception exc)
    {
        #>
        /*
        <#= exc.Message + " " + exc.StackTrace #>
        */
        <#
    }
#>
/*
*	Important ! 
*     this file preprocessed with t4 template - TextTemplatingFileGenerator
*
*   CodeGeneration parameters:
*       MessageType			'<#= MessageType #>'
*       RestApiBaseUri		'<#= RestApiBaseUri #>'
*
*   Request:
*       DateTime            '<#= DateTime.Now.ToString() #>'
*       SchemeModelHash     '<#= model == null ? "" : model.CalculateSchemeHash() #>'
*
*/

namespace <#= System.Runtime.Remoting.Messaging.CallContext.LogicalGetData("NamespaceHint") #>
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    
    public class EMail : TaskQueue.Providers.TaskMessage
    {
        const string MType = "<#= MessageType #>";
        public EMail()
            : base(MType)
        {

        }
        public EMail(TaskQueue.Providers.TaskMessage holder)
            : base(holder.MType)
        {
            this.SetHolder(holder.GetHolder());
        }
        public EMail(Dictionary<string, object> holder)
            : base(MType)
        {
            this.SetHolder(holder);
        }

<#
    if(result != null)
    {
foreach(KeyValuePair<string, TaskQueue.RepresentedModelValue> item in result)
{
    if(item.Value.Inherited)
    {
        continue;
    }
#>
        /// <summary>
        /// <#= item.Value.Description!=null ? item.Value.Description : "" #>	
        /// <#= item.Value.Required ?"REQUIRED !":"" #>
        /// </summary>	
        public <#=TaskQueue.RepresentedModel.GetLTypeString(item.Value.VType)#> <#= item.Key #> { get; set; }
<#}
}#>
    }
}